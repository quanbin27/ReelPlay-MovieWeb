<!DOCTYPE html>
<html lang="en">

<!-- Mirrored from hotflix.volkovdesign.com/main/search-results.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Oct 2024 14:32:45 GMT -->
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<!-- CSS -->
	<link rel="stylesheet" href="css/bootstrap.min.css">
	<link rel="stylesheet" href="css/splide.min.css">
	<link rel="stylesheet" href="css/slimselect.css">
	<link rel="stylesheet" href="css/plyr.css">
	<link rel="stylesheet" href="css/photoswipe.css">
	<link rel="stylesheet" href="css/default-skin.css">
	<link rel="stylesheet" href="css/main.css">

	<!-- Icon font -->
	<link rel="stylesheet" href="webfont/tabler-icons.min.css">

	<!-- Favicons -->
	<link rel="icon" type="image/png" href="icon/favicon-32x32.png" sizes="32x32">
	<link rel="apple-touch-icon" href="icon/favicon-32x32.png">

	<meta name="description" content="Online Movies, TV Shows & Cinema HTML Template">
	<meta name="keywords" content="">
	<meta name="author" content="Dmitry Volkov">
	<title>HotFlix – Online Movies, TV Shows & Cinema HTML Template</title>
</head>

<body>
	<!-- header -->
	<header class="header">
		<div class="container">
			<div class="row">
				<div class="col-12">
					<div class="header__content">
						<!-- header logo -->
						<a href="index.html" class="header__logo">
							<img src="img/logo.svg" alt="">
						</a>
						<!-- end header logo -->

						<!-- header nav -->
						<ul class="header__nav">
							<!-- dropdown -->
							<li class="header__nav-item">
								<a class="header__nav-link" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">Home <i class="ti ti-chevron-down"></i></a>

								<ul class="dropdown-menu header__dropdown-menu">
									<li><a href="index.html">Home style 1</a></li>
									<li><a href="index2.html">Home style 2</a></li>
									<li><a href="index3.html">Home style 3</a></li>
								</ul>
							</li>
							<!-- end dropdown -->

							<!-- dropdown -->
							<li class="header__nav-item">
								<a class="header__nav-link" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">Catalog <i class="ti ti-chevron-down"></i></a>

								<ul class="dropdown-menu header__dropdown-menu">
									<li><a href="catalog.html">Catalog style 1</a></li>
									<li><a href="search-results.html">Catalog style 2</a></li>
									<li><a href="details.html">Details Movie</a></li>
									<li><a href="watch.html">Details TV Series</a></li>
								</ul>
							</li>
							<!-- end dropdown -->

							<li class="header__nav-item">
								<a href="pricing.html" class="header__nav-link">Pricing plan</a>
							</li>

							<!-- dropdown -->
							<li class="header__nav-item">
								<a class="header__nav-link" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">Pages <i class="ti ti-chevron-down"></i></a>

								<ul class="dropdown-menu header__dropdown-menu">
									<li><a href="about.html">About Us</a></li>
									<li><a href="profile.html">Profile</a></li>
									<li><a href="actor.html">Actor</a></li>
									<li><a href="contacts.html">Contacts</a></li>
									<li><a href="faq.html">Help center</a></li>
									<li><a href="privacy.html">Privacy policy</a></li>
									<li><a href="https://hotflix.volkovdesign.com/admin/index.html" target="_blank">Admin pages</a></li>
								</ul>
							</li>
							<!-- end dropdown -->

							<!-- dropdown -->
							<li class="header__nav-item">
								<a class="header__nav-link header__nav-link--more" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false"><i class="ti ti-dots"></i></a>

								<ul class="dropdown-menu header__dropdown-menu">
									<li><a href="signin.html">Sign in</a></li>
									<li><a href="signup.html">Sign up</a></li>
									<li><a href="forgot.html">Forgot password</a></li>
									<li><a href="404.html">404 Page</a></li>
								</ul>
							</li>
							<!-- end dropdown -->
						</ul>
						<!-- end header nav -->

						<!-- header auth -->
						<div class="header__auth">
							<form action="#" class="header__search">
								<input class="header__search-input" type="text" placeholder="Search...">
								<button class="header__search-button" type="button">
									<i class="ti ti-search"></i>
								</button>
								<button class="header__search-close" type="button">
									<i class="ti ti-x"></i>
								</button>
							</form>

							<button class="header__search-btn" type="button">
								<i class="ti ti-search"></i>
							</button>

							<!-- dropdown -->
							<div class="header__lang">
								<a class="header__nav-link" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">EN <i class="ti ti-chevron-down"></i></a>

								<ul class="dropdown-menu header__dropdown-menu">
									<li><a href="#">English</a></li>
									<li><a href="#">Spanish</a></li>
									<li><a href="#">French</a></li>
								</ul>
							</div>
							<!-- end dropdown -->

							<a href="signin.html" class="header__sign-in">
								<i class="ti ti-login"></i>
								<span>sign in</span>
							</a>
						</div>
						<!-- end header auth -->

						<!-- header menu btn -->
						<button class="header__btn" type="button">
							<span></span>
							<span></span>
							<span></span>
						</button>
						<!-- end header menu btn -->
					</div>
				</div>
			</div>
		</div>
	</header>
	<!-- end header -->
	
	<!-- page title -->
	<section class="section section--first">
		<div class="container">
			<div class="row">
				<div class="col-12">
					<div class="section__wrap">
						<!-- section title -->
						<h1 class="section__title section__title--head">Search Result</h1>
						<!-- end section title -->

						<!-- breadcrumbs -->
						<ul class="breadcrumbs">
							<li class="breadcrumbs__item"><a href="/index">Home</a></li>
							<li class="breadcrumbs__item breadcrumbs__item--active">Search</li>
						</ul>
						<!-- end breadcrumbs -->
					</div>
				</div>
			</div>
		</div>
	</section>
	<!-- end page title -->
	<!-- fixed filter wrap -->
	<div>
		

		<div class="section section--catalog">
			<div class="container">
				<div class="row" id="movie-list">
					<!-- Movies sẽ được thêm vào đây bằng JS -->
				</div>

				<div class="row">
					<!-- paginator -->
					<div class="col-12">
						<!-- paginator mobile -->
						<div class="paginator-mob">
							<span class="paginator-mob__pages" id="pagination-info">0 of 0</span>
							<ul class="paginator-mob__nav">
								<li>
									<a href="#" id="prev-page">
										<i class="ti ti-chevron-left"></i>
										<span>Prev</span>
									</a>
								</li>
								<li>
									<a href="#" id="next-page">
										<span>Next</span>
										<i class="ti ti-chevron-right"></i>
									</a>
								</li>
							</ul>
						</div>
						<!-- end paginator mobile -->

						<!-- paginator desktop -->
						<ul class="paginator" id="pagination">
							<!-- Pagination sẽ được tạo bằng JS -->
						</ul>
						<!-- end paginator desktop -->
					</div>
				</div>
			</div>
		</div>

		<!-- end catalog -->
	</div>
	<!-- end fixed filter wrap -->

	<!-- section -->

	<!-- footer -->
	<footer class="footer">
		<div class="container">
			<div class="row">
				<div class="col-12">
					<div class="footer__content">
						<a href="index.html" class="footer__logo">
							<img src="img/logo.svg" alt="">
						</a>

						<span class="footer__copyright">© HOTFLIX, 2019—2024 <br> Create by <a href="https://themeforest.net/user/dmitryvolkov/portfolio" target="_blank">Dmitry Volkov</a></span>

						<nav class="footer__nav">
							<a href="about.html">About Us</a>
							<a href="contacts.html">Contacts</a>
							<a href="privacy.html">Privacy policy</a>
						</nav>

						<button class="footer__back" type="button">
							<i class="ti ti-arrow-narrow-up"></i>
						</button>
					</div>
				</div>
			</div>
		</div>
	</footer>
	<!-- end footer -->

	<!-- mobile filter -->
	<div class="mfilter">
		<div class="mfilter__head">
			<h6 class="mfilter__title">Filter</h6>

			<button class="mfilter__close" type="button"><i class="ti ti-x"></i></button>
		</div>

		<div class="mfilter__select-wrap">
			<div class="sign__group">
				<select class="filter__select" name="mgenre" id="mfilter__genre">
					<option value="0">All genres</option>
					<option value="1">Action/Adventure</option>
					<option value="2">Animals</option>
					<option value="3">Animation</option>
					<option value="4">Biography</option>
					<option value="5">Comedy</option>
					<option value="6">Cooking</option>
					<option value="7">Dance</option>
					<option value="8">Documentary</option>
					<option value="9">Drama</option>
					<option value="10">Education</option>
					<option value="11">Entertainment</option>
					<option value="12">Family</option>
					<option value="13">Fantasy</option>
					<option value="14">History</option>
					<option value="15">Horror</option>
					<option value="16">Independent</option>
					<option value="17">International</option>
					<option value="18">Kids</option>
					<option value="19">Medical</option>
					<option value="20">Military/War</option>
					<option value="21">Music</option>
					<option value="22">Mystery/Crime</option>
					<option value="23">Nature</option>
					<option value="24">Paranormal</option>
					<option value="25">Politics</option>
					<option value="26">Racing</option>
					<option value="27">Romance</option>
					<option value="28">Sci-Fi/Horror</option>
					<option value="29">Science</option>
					<option value="30">Science Fiction</option>
					<option value="31">Science/Nature</option>
					<option value="32">Spanish</option>
					<option value="33">Travel</option>
					<option value="34">Western</option>
				</select>
			</div>

			<div class="sign__group">
				<select class="filter__select" name="mquality" id="mfilter__quality">
					<option value="0">Any quality</option>
					<option value="1">HD 1080</option>
					<option value="2">HD 720</option>
					<option value="3">DVD</option>
					<option value="4">TS</option>
				</select>
			</div>

			<div class="sign__group">
				<select class="filter__select" name="mrate" id="mfilter__rate">
					<option value="0">Any rating</option>
					<option value="1">from 3.0</option>
					<option value="2">from 5.0</option>
					<option value="3">from 7.0</option>
					<option value="4">Golder Star</option>
				</select>
			</div>

			<div class="sign__group">
				<select class="filter__select" name="msort" id="mfilter__sort">
					<option value="0">Relevance</option>
					<option value="1">Newest</option>
					<option value="2">Oldest</option>
				</select>
			</div>
		</div>

		<button class="mfilter__apply" type="button">Apply</button>
	</div>
	<!-- end mobile filter -->

	<!-- JS -->
	<script src="js/bootstrap.bundle.min.js"></script>
	<script src="js/splide.min.js"></script>
	<script src="js/slimselect.min.js"></script>
	<script src="js/smooth-scrollbar.js"></script>
	<script src="js/plyr.min.js"></script>
	<script src="js/photoswipe.min.js"></script>
	<script src="js/photoswipe-ui-default.min.js"></script>
	<script src="js/main.js"></script>
	<script>
		document.addEventListener('DOMContentLoaded', async function () {
			const movieListEl = document.getElementById('movie-list');
			const paginationEl = document.getElementById('pagination');
			const paginationInfoEl = document.getElementById('pagination-info');
			const prevPageBtn = document.getElementById('prev-page');
			const nextPageBtn = document.getElementById('next-page');

			let currentPage = 1;
			let limit = 18;
			let totalResults = 0;
			let totalPages = 0;

			// Lấy query params từ URL
			const urlParams = new URLSearchParams(window.location.search);
			const query = urlParams.get('q') || '';
			currentPage = parseInt(urlParams.get('page')) || 1;
			limit = parseInt(urlParams.get('limit')) || 18;

			// Hàm gọi API để lấy dữ liệu phim
			async function fetchMovies(query, page, limit) {
				try {
					const response = await fetch(`http://localhost:8080/api/v1/movie/search?q=${encodeURIComponent(query)}&page=${page}&limit=${limit}`, {
						headers: {
							'Authorization': `Bearer ${localStorage.getItem('token')}`,
							'Content-Type': 'application/json',
						},
					});
					const data = await response.json();

					if (!data.totalResults) {
						console.error('API does not return totalResults.');
						return [];
					}

					totalResults = data.totalResults || 0; // Đảm bảo lấy tổng số kết quả từ API
					totalPages = Math.ceil(totalResults / limit); // Tính tổng số trang

					console.log(`Total results: ${totalResults}, Total pages: ${totalPages}`); // Kiểm tra số trang

					return data.data; // Trả về mảng phim từ data
				} catch (error) {
					console.error('Error fetching movies:', error);
					return [];
				}
			}



			// Hàm hiển thị danh sách phim
			function renderMovies(movies) {
				movieListEl.innerHTML = ''; // Xóa nội dung cũ

				if (movies.length === 0) {
					movieListEl.innerHTML = '<p>No movies found</p>';
					return;
				}

				movies.forEach(movie => {
					const movieEl = `
                <div class="col-6 col-sm-4 col-lg-3 col-xl-2">
                    <div class="item">
                        <div class="item__cover">
                            <img src="${movie.thumbnail}" alt="${movie.name}">
                            <a href="details.html?movieId=${movie.id}" class="item__play">
                                <i class="ti ti-player-play-filled"></i>
                            </a>
                            <span class="item__rate item__rate--green">${movie.rate}</span>
                            <button class="item__favorite" type="button"><i class="ti ti-bookmark"></i></button>
                        </div>
                        <div class="item__content">
                            <h3 class="item__title"><a href="details.html?movieId=${movie.id}">${movie.name}</a></h3>
                            <span class="item__category">
                                ${movie.category.map(genre => `<a href="#">${genre}</a>`).join(', ')}
                            </span>
                        </div>
                    </div>
                </div>
            `;
					movieListEl.insertAdjacentHTML('beforeend', movieEl);
				});
			}

			// Hàm cập nhật thông tin phân trang
			function updatePagination() {
				paginationInfoEl.textContent = `${(currentPage - 1) * limit + 1} - ${Math.min(currentPage * limit, totalResults)} of ${totalResults}`;

				paginationEl.innerHTML = ''; // Xóa nội dung cũ

				// Nút trang trước
				if (currentPage > 1) {
					const prevEl = `<li class="paginator__item paginator__item--prev"><a href="?q=${encodeURIComponent(query)}&page=${currentPage - 1}&limit=${limit}"><i class="ti ti-chevron-left"></i></a></li>`;
					paginationEl.insertAdjacentHTML('beforeend', prevEl);
				}

				// Các nút số trang
				for (let i = 1; i <= totalPages; i++) {
					const activeClass = i === currentPage ? 'paginator__item--active' : '';
					const pageEl = `<li class="paginator__item ${activeClass}"><a href="?q=${encodeURIComponent(query)}&page=${i}&limit=${limit}">${i}</a></li>`;
					paginationEl.insertAdjacentHTML('beforeend', pageEl);
				}

				// Nút trang tiếp theo
				if (currentPage < totalPages) {
					const nextEl = `<li class="paginator__item paginator__item--next"><a href="?q=${encodeURIComponent(query)}&page=${currentPage + 1}&limit=${limit}"><i class="ti ti-chevron-right"></i></a></li>`;
					paginationEl.insertAdjacentHTML('beforeend', nextEl);
				}
			}


			// Tải dữ liệu phim và hiển thị kết quả
			const movies = await fetchMovies(query, currentPage, limit);
			renderMovies(movies);
			updatePagination();

			// Sự kiện cho nút "Previous" và "Next" ở phân trang mobile
			prevPageBtn.addEventListener('click', function () {
				if (currentPage > 1) {
					window.location.href = `?q=${encodeURIComponent(query)}&page=${currentPage - 1}&limit=${limit}`;
				}
			});

			nextPageBtn.addEventListener('click', function () {
				if (currentPage < totalPages) {
					window.location.href = `?q=${encodeURIComponent(query)}&page=${currentPage + 1}&limit=${limit}`;
				}
			});
		});

	</script>
</body>

<!-- Mirrored from hotflix.volkovdesign.com/main/search-results.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Oct 2024 14:32:45 GMT -->
</html>