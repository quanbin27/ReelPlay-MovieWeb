<!DOCTYPE html>
<html lang="en">

<!-- Mirrored from hotflix.volkovdesign.com/main/profile.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Oct 2024 14:32:56 GMT -->
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<!-- CSS -->
	<link rel="stylesheet" href="css/bootstrap.min.css">
	<link rel="stylesheet" href="css/splide.min.css">
	<link rel="stylesheet" href="css/slimselect.css">
	<link rel="stylesheet" href="css/plyr.css">
	<link rel="stylesheet" href="css/photoswipe.css">
	<link rel="stylesheet" href="css/default-skin.css">
	<link rel="stylesheet" href="css/main.css">

	<!-- Icon font -->
	<link rel="stylesheet" href="webfont/tabler-icons.min.css">
	<script src="../js/logout.js"></script>
	<!-- Favicons -->
	<link rel="icon" type="image/png" href="icon/favicon-32x32.png" sizes="32x32">
	<link rel="apple-touch-icon" href="icon/favicon-32x32.png">

	<meta name="description" content="Online Movies, TV Shows & Cinema HTML Template">
	<meta name="keywords" content="">
	<meta name="author" content="Dmitry Volkov">
	<title>ReelPlay – Online Movies, TV Shows & Cinema HTML Template</title>
</head>

<body>
	<!-- header -->
	<header class="header">
		<div class="container">
			<div class="row">
				<div class="col-12">
					<div class="header__content">
						<!-- header logo -->
						<a href="/index" class="header__logo">
							<img src="img/logo.svg" alt="">
						</a>
						<!-- end header logo -->

						<!-- header nav -->
						<ul class="header__nav">
							<!-- dropdown -->
							<li class="header__nav-item">
								<a class="header__nav-link" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">Category <i class="ti ti-chevron-down"></i></a>

								<ul class="dropdown-menu header__dropdown-menu">
									<li><a href="/search?q=action&page=1&limit=54">Action</a></li>
									<li><a href="/search?q=adventure&page=1&limit=54">Adventure</a></li>
									<li><a href="/search?q=animation&page=1&limit=54">Animation</a></li>
									<li><a href="/search?q=biography&page=1&limit=54">Biography</a></li>
									<li><a href="/search?q=comedy&page=1&limit=54">Comedy</a></li>
									<li><a href="/search?q=crime&page=1&limit=54">Crime</a></li>
									<li><a href="/search?q=drama&page=1&limit=54">Drama</a></li>
									<li><a href="/search?q=fantasy&page=1&limit=54">Fantasy</a></li>
									<li><a href="/search?q=history&page=1&limit=54">History</a></li>
									<li><a href="/search?q=horror&page=1&limit=54">Horror</a></li>
									<li><a href="/search?q=music&page=1&limit=54">Music</a></li>
									<li><a href="/search?q=mystery&page=1&limit=54">Mystery</a></li>
									<li><a href="/search?q=romance&page=1&limit=54">Romance</a></li>
									<li><a href="/search?q=sci-fi&page=1&limit=54">Sci-Fi</a></li>
									<li><a href="/search?q=sport&page=1&limit=54">Sport</a></li>
									<li><a href="/search?q=thriller&page=1&limit=54">Thriller</a></li>
									<li><a href="/search?q=war&page=1&limit=54">War</a></li>


								</ul>
							</li>
							<!-- end dropdown -->

							<!-- dropdown -->
							<li class="header__nav-item">
								<a class="header__nav-link" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">Country <i class="ti ti-chevron-down"></i></a>

								<ul class="dropdown-menu header__dropdown-menu-grid" style="">
									<li><a href="/search?q=usa&page=1&limit=54">USA</a></li>
									<li><a href="/search?q=united+kingdom&page=1&limit=54">United Kingdom</a></li>
									<li><a href="/search?q=south+korea&page=1&limit=54">South Korea</a></li>
									<li><a href="/search?q=china&page=1&limit=54">China</a></li>
									<li><a href="/search?q=japan&page=1&limit=54">Japan</a></li>
									<li><a href="/search?q=india&page=1&limit=54">India</a></li>
									<li><a href="/search?q=france&page=1&limit=54">France</a></li>
									<li><a href="/search?q=germany&page=1&limit=54">Germany</a></li>
									<li><a href="/search?q=canada&page=1&limit=54">Canada</a></li>
									<li><a href="/search?q=turkey&page=1&limit=54">Turkey</a></li>
									<li><a href="/search?q=spain&page=1&limit=54">Spain</a></li>
									<li><a href="/search?q=philippines&page=1&limit=54">Philippines</a></li>
									<li><a href="/search?q=italy&page=1&limit=54">Italy</a></li>
									<li><a href="/search?q=brazil&page=1&limit=54">Brazil</a></li>
									<li><a href="/search?q=russia&page=1&limit=54">Russia</a></li>
									<li><a href="/search?q=australia&page=1&limit=54">Australia</a></li>
									<li><a href="/search?q=hong+kong&page=1&limit=54">Hong Kong</a></li>
									<li><a href="/search?q=thailand&page=1&limit=54">Thailand</a></li>
									<li><a href="/search?q=portugal&page=1&limit=54">Portugal</a></li>
									<li><a href="/search?q=poland&page=1&limit=54">Poland</a></li>
									<li><a href="/search?q=netherlands&page=1&limit=54">Netherlands</a></li>
									<li><a href="/search?q=denmark&page=1&limit=54">Denmark</a></li>
									<li><a href="/search?q=norway&page=1&limit=54">Norway</a></li>
									<li><a href="/search?q=ukraine&page=1&limit=54">Ukraine</a></li>
									<li><a href="/search?q=taiwan&page=1&limit=54">Taiwan</a></li>
									<li><a href="/search?q=other+country&page=1&limit=54">Other country</a></li>


								</ul>
							</li>
							<!-- end dropdown -->

							<li class="header__nav-item">
								<a href="/new-movie" class="header__nav-link">New movies</a>
							</li>

							<!-- dropdown -->
							<li class="header__nav-item">
								<a class="header__nav-link" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">Pages <i class="ti ti-chevron-down"></i></a>

								<ul class="dropdown-menu header__dropdown-menu">
									<li><a href="/about">About Us</a></li>
									<li><a href="/contacts">Contacts</a></li>
									<li><a href="/faq">Help center</a></li>
									<li><a href="/privacy">Privacy policy</a></li>
								</ul>
							</li>
							<!-- end dropdown -->

							<!-- dropdown -->
							<li class="header__nav-item">
								<a class="header__nav-link header__nav-link--more" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false"><i class="ti ti-dots"></i></a>

								<ul class="dropdown-menu header__dropdown-menu">
									<li><a href="/new-feature">Feature Film</a></li>
									<li><a href="/new-series">New Series</a></li>
								</ul>
							</li>
							<!-- end dropdown -->
						</ul>
						<!-- end header nav -->

						<!-- header auth -->
						<div class="header__auth">
							<form action="#" class="header__search">
								<input class="header__search-input" id="search-input" type="text" placeholder="Search...">
								<button class="header__search-button" type="button" id="search-btn">
									<i class="ti ti-search"></i>
								</button>
								<button class="header__search-close" type="button">
									<i class="ti ti-x"></i>
								</button>
							</form>


							<button class="header__search-btn" type="button">
								<i class="ti ti-search"></i>
							</button>

							<div class="header__profile">
								<a href="#" class="header__sign-in header__sign-in--user" role="button" id="profileLink">
									<i class="ti ti-user"></i>
									<span id="profileText">SIGN IN</span>
								</a>
							</div>
							<!-- end dropdown -->
						</div>
						<!-- end header auth -->

					</div>
				</div>
			</div>
		</div>
	</header>
	<!-- end header -->

	<!-- page title -->
	<section class="section section--first">
		<div class="container">
			<div class="row">
				<div class="col-12">
					<div class="section__wrap">
						<!-- section title -->
						<h1 class="section__title section__title--head">My Profile</h1>
						<!-- end section title -->

						<!-- breadcrumbs -->
						<ul class="breadcrumbs">
							<li class="breadcrumbs__item"><a href="/index">Home</a></li>
							<li class="breadcrumbs__item breadcrumbs__item--active">Profile</li>
						</ul>
						<!-- end breadcrumbs -->
					</div>
				</div>
			</div>
		</div>
	</section>
	<!-- end page title -->

	<!-- content -->
	<div class="content">
		<!-- profile -->
		<div class="profile">
			<div class="container">
				<div class="row">
					<div class="col-12">
						<div class="profile__content">
							<div class="profile__user">
								<div class="profile__avatar">
									<img src="img/user.svg" alt="">
								</div>
								<div class="profile__meta">
									<h3 id="name-user"></h3>

								</div>
							</div>

							<!-- content tabs nav -->
							<ul class="nav nav-tabs content__tabs content__tabs--profile" id="content__tabs" role="tablist">
								<li class="nav-item" role="presentation">
									<button id="1-tab" class="active" data-bs-toggle="tab" data-bs-target="#tab-1" type="button" role="tab" aria-controls="tab-1" aria-selected="true">Watching</button>
								</li>

<!--								<li class="nav-item" role="presentation">-->
<!--									<button id="2-tab" data-bs-toggle="tab" data-bs-target="#tab-2" type="button" role="tab" aria-controls="tab-2" aria-selected="false">Watching</button>-->
<!--								</li>-->

								<li class="nav-item" role="presentation">
									<button id="3-tab" data-bs-toggle="tab" data-bs-target="#tab-3" type="button" role="tab" aria-controls="tab-3" aria-selected="false">Favorites</button>
								</li>

								<li class="nav-item" role="presentation">
									<button id="4-tab" data-bs-toggle="tab" data-bs-target="#tab-4" type="button" role="tab" aria-controls="tab-4" aria-selected="false">Settings</button>
								</li>
							</ul>
							<!-- end content tabs nav -->

							<!-- logout -->
							<button class="profile__logout" type="button" onclick="logout()">
								<i class="ti ti-logout"></i>
								<span>Logout</span>
							</button>
							<!-- end logout -->
						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- end profile -->

		<div class="container">
			<!-- content tabs -->
			<div class="tab-content">
				<div class="tab-pane fade show active" id="tab-1" role="tabpanel" aria-labelledby="1-tab" tabindex="0">
					<div class="row" id="watchinglist">
						<!-- item -->
						<div class="col-6 col-sm-4 col-lg-3 col-xl-2">
							<div class="item">
								<div class="item__cover">
									<img src="img/covers/cover.jpg" alt="">
									<a href="details.html" class="item__play">
										<i class="ti ti-player-play-filled"></i>
									</a>
									<span class="item__rate item__rate--green">8.4</span>
									<button class="item__favorite item__favorite--active" type="button"><i class="ti ti-bookmark"></i></button>
								</div>
								<div class="item__content">
									<h3 class="item__title"><a href="details.html">I Dream in Another Language</a></h3>
									<span class="item__category">
										<a href="#">Action</a>
										<a href="#">Triler</a>
									</span>
								</div>
							</div>
						</div>
					</div>
				</div>


				<div class="tab-pane fade" id="tab-3" role="tabpanel" aria-labelledby="3-tab" tabindex="0">
					<div class="row" id="bookmarklist">
						<!-- item -->
						<div class="col-6 col-sm-4 col-lg-3 col-xl-2">
							<div class="item">
								<div class="item__cover">
									<img src="img/covers/cover.jpg" alt="">
									<a href="details.html" class="item__play">
										<i class="ti ti-player-play-filled"></i>
									</a>
									<span class="item__rate item__rate--green">8.4</span>
									<button class="item__favorite item__favorite--active" type="button"><i class="ti ti-bookmark"></i></button>
								</div>
								<div class="item__content">
									<h3 class="item__title"><a href="details.html">I Dream in Another Language</a></h3>
									<span class="item__category">
										<a href="#">Action</a>
										<a href="#">Triler</a>
									</span>
								</div>
							</div>
						</div>
					</div>	<!-- end item -->
				</div>

				<div class="tab-pane fade" id="tab-4" role="tabpanel" aria-labelledby="4-tab" tabindex="0">
					<div class="row">
						<!-- details form -->
						<div class="col-12 col-lg-6">
							<form action="#" class="sign__form sign__form--full">
								<div class="row">
									<div class="col-12">
										<h4 class="sign__title">Profile details</h4>
									</div>

									<div class="col-12 col-md-6 col-lg-12 col-xl-6">
										<div class="sign__group">
											<label class="sign__label" for="firstName">First Name</label>
											<input id="firstName" type="text" name="firstName" class="sign__input" placeholder="User 123">
										</div>
									</div>

									<div class="col-12 col-md-6 col-lg-12 col-xl-6">
										<div class="sign__group">
											<label class="sign__label" for="email">Email</label>
											<input id="email" type="text" name="email" class="sign__input" placeholder="email@email.com">
										</div>
									</div>

									<div class="col-12 col-md-6 col-lg-12 col-xl-6">
										<div class="sign__group">
											<label class="sign__label" for="fname">Last Name</label>
											<input id="fname" type="text" name="fname" class="sign__input" placeholder="John Doe">
										</div>
									</div>

									<div class="col-12">
										<button id="btnSaveProfile" class="sign__btn sign__btn--small" type="button">Save</button>
									</div>
								</div>
							</form>
						</div>
						<!-- end details form -->

						<!-- password form -->
						<div class="col-12 col-lg-6">
							<form action="#" class="sign__form sign__form--full">
								<div class="row">
									<div class="col-12">
										<h4 class="sign__title">Change password</h4>
									</div>

									<div class="col-12 col-md-6 col-lg-12 col-xl-6">
										<div class="sign__group">
											<label class="sign__label" for="oldpass">Old password</label>
											<input id="oldpass" type="password" name="oldpass" class="sign__input">
										</div>
									</div>

									<div class="col-12 col-md-6 col-lg-12 col-xl-6">
										<div class="sign__group">
											<label class="sign__label" for="newpass">New password</label>
											<input id="newpass" type="password" name="newpass" class="sign__input">
										</div>
									</div>

									<div class="col-12 col-md-6 col-lg-12 col-xl-6">
										<div class="sign__group">
											<label class="sign__label" for="confirmpass">Confirm new password</label>
											<input id="confirmpass" type="password" name="confirmpass" class="sign__input">
										</div>
									</div>

<!--&lt;!&ndash;					-->
									<div class="col-12">
										<button id="btnChangePassword" class="sign__btn sign__btn--small" type="button">Change</button>
									</div>
								</div>
							</form>
						</div>
						<!-- end password form -->
					</div>
				</div>
			</div>
			<!-- end content tabs -->
		</div>
	</div>
	<!-- end content -->

	<!-- footer -->
	<footer class="footer">
		<div class="container">
			<div class="row">
				<div class="col-12">
					<div class="footer__content">
						<a href="/index" class="footer__logo">
							<img src="img/logo.svg" alt="">
						</a>


						<nav class="footer__nav">
							<a href="/about">About Us</a>
							<a href="/contacts">Contacts</a>
							<a href="/privacy">Privacy policy</a>
						</nav>

						<button class="footer__back" type="button">
							<i class="ti ti-arrow-narrow-up"></i>
						</button>
					</div>
				</div>
			</div>
		</div>
	</footer>
	<!-- end footer -->



	<!-- JS -->
	<script src="js/bootstrap.bundle.min.js"></script>
	<script src="js/splide.min.js"></script>
	<script src="js/slimselect.min.js"></script>
	<script src="js/smooth-scrollbar.js"></script>
	<script src="js/plyr.min.js"></script>
	<script src="js/photoswipe.min.js"></script>
	<script src="js/photoswipe-ui-default.min.js"></script>
	<script src="js/main.js"></script>
	<script>
		// Lấy token từ store (đoạn mã giả định rằng bạn có phương thức `getTokenFromStore` để lấy token)
		const token = localStorage.getItem('token');

		// Cấu hình headers kèm token
		const headers = {
			'Authorization': `Bearer ${token}`,
			'Content-Type': 'application/json'
		};

		// Hàm lấy thông tin người dùng và điền vào form "Profile details"
		async function loadProfileDetails() {
			try {
				const response = await fetch('http://localhost:8080/api/v1/me/info', {
					method: 'GET',
					headers: headers
				});

				if (response.ok) {
					const data = await response.json();
					document.getElementById('firstName').value = data.firstName || '';
					document.getElementById('fname').value = data.lastName || '';
					document.getElementById('email').value = data.email || '';
					document.getElementById('name-user').innerText = data.firstName || '';
				} else {
					console.error('Lỗi khi lấy thông tin người dùng:', response.statusText);
				}
			} catch (error) {
				console.error('Lỗi kết nối API:', error);
			}
		}

		// Hàm cập nhật thông tin người dùng từ form "Profile details"
		async function updateProfileDetails() {
			const userData = {
				first_name: document.getElementById('firstName').value,
				last_name: document.getElementById('fname').value,
				email: document.getElementById('email').value
			};

			try {
				const response = await fetch('http://localhost:8080/api/v1/me/info', {
					method: 'PUT',
					headers: headers,
					body: JSON.stringify(userData)
				});

				if (response.ok) {
					alert('Cập nhật thông tin thành công!');
				} else {
					const errorData = await response.json();
					alert('Lỗi: ' + errorData.error);
				}
			} catch (error) {
				console.error('Lỗi kết nối API:', error);
			}
		}

		// Hàm đổi mật khẩu
		async function changePassword() {
			const passwordData = {
				old_password: document.getElementById('oldpass').value,
				new_password: document.getElementById('newpass').value,
				confirm_password: document.getElementById('confirmpass').value
			};
			console.log(passwordData);
			try {
				const response = await fetch('http://localhost:8080/api/v1/me/password', {
					method: 'PUT',
					headers: headers,
					body: JSON.stringify(passwordData)
				});

				if (response.ok) {
					alert('Đổi mật khẩu thành công!');
				} else {
					const errorData = await response.json();
					alert('Lỗi: ' + errorData.error);
				}
			} catch (error) {
				console.error('Lỗi kết nối API:', error);
			}
		}

		// Gọi hàm loadProfileDetails khi tải trang
		document.addEventListener('DOMContentLoaded', loadProfileDetails);

		// Gán sự kiện click cho nút "Save" và "Change"
		document.addEventListener('DOMContentLoaded', () => {
			document.getElementById('btnSaveProfile').addEventListener('click', updateProfileDetails);
			document.getElementById('btnChangePassword').addEventListener('click', changePassword);
		});
		async function loadBookmarks() {
			try {
				const response = await fetch('http://localhost:8080/api/v1/me/bookmarks', {
					method: 'GET',
					headers: headers
				});

				if (response.ok) {
					const bookmarks = await response.json();
					const bookmarksContainer = document.querySelector('#bookmarklist'); // Lựa chọn container để chứa danh sách bookmarks

					// Xóa nội dung cũ nếu có
					bookmarksContainer.innerHTML = '';

					bookmarks?.forEach(bookmark => {
						const categoryLinks = bookmark.category.map(cat => `<a href="#">${cat}</a>`).join(" ");

						// Tạo phần tử HTML cho từng mục bookmark
						const bookmarkItem = `
                    <div class="col-6 col-sm-4 col-lg-3 col-xl-2">
                        <div class="item">
                            <div class="item__cover">
                                <img src="${bookmark.thumbnail}" alt="${bookmark.name}">
                                <a href="/detail?movieId=${bookmark.id}" class="item__play">
                                    <i class="ti ti-player-play-filled"></i>
                                </a>
                                <span class="item__rate item__rate--green">${bookmark.rate}</span>

                            </div>
                            <div class="item__content">
                                <h3 class="item__title">
                                    <a href="details.html?id=${bookmark.id}">${bookmark.name}</a>
                                </h3>
                                <span class="item__category">
                                    ${categoryLinks}
                                </span>
                            </div>
                        </div>
                    </div>
                `;

						// Thêm phần tử mới vào container
						bookmarksContainer.innerHTML += bookmarkItem;
					});
				} else {
					console.error('Lỗi khi tải bookmarks:', response.error);
					alert('Không thể tải bookmarks.');
				}
			} catch (error) {
				console.error('Lỗi kết nối API:', error);
				alert('Lỗi kết nối đến server.');
			}
		}
		async function loadWatching() {
			try {
				const response = await fetch('http://localhost:8080/api/v1/me/watching', {
					method: 'GET',
					headers: headers
				});

				if (response.ok) {
					const bookmarks = await response.json();
					const bookmarksContainer = document.querySelector('#watchinglist'); // Lựa chọn container để chứa danh sách bookmarks

					// Xóa nội dung cũ nếu có
					bookmarksContainer.innerHTML = '';

					bookmarks?.forEach(bookmark => {
						const categoryLinks = bookmark.category.map(cat => `<a href="#">${cat}</a>`).join(" ");

						// Tạo phần tử HTML cho từng mục bookmark
						const bookmarkItem = `
                    <div class="col-6 col-sm-4 col-lg-3 col-xl-2">
                        <div class="item">
                            <div class="item__cover">
                                <img src="${bookmark.thumbnail}" alt="${bookmark.name}">
                                <a href="/detail?movieId=${bookmark.id}" class="item__play">
                                    <i class="ti ti-player-play-filled"></i>
                                </a>
                                <span class="item__rate item__rate--green">${bookmark.rate}</span>

                            </div>
                            <div class="item__content">
                                <h3 class="item__title">
                                    <a href="details.html?id=${bookmark.id}">${bookmark.name}</a>
                                </h3>
                                <span class="item__category">
                                    ${categoryLinks}
                                </span>
                            </div>
                        </div>
                    </div>
                `
						;

						// Thêm phần tử mới vào container
						bookmarksContainer.innerHTML += bookmarkItem;
						});
				} else {
					console.error('Lỗi khi tải watching:', response.error);
					alert('Không thể tải bookmarks.');
				}
			} catch (error) {
				console.error('Lỗi kết nối API:', error);
				alert('Lỗi kết nối đến server.');
			}
		}

		// Gọi hàm loadBookmarks khi tải trang
		document.addEventListener('DOMContentLoaded', loadBookmarks);
		document.addEventListener('DOMContentLoaded', loadWatching);
	</script>
	<script>
		const profileLink = document.getElementById('profileLink');
		const profileText = document.getElementById('profileText');

		if (token) {
			// Nếu có token, thay đổi liên kết thành trang profile và hiển thị 'PROFILE'
			profileLink.href = '/profile';
			profileText.textContent = 'PROFILE';
		} else {
			// Nếu không có token, dẫn đến trang đăng nhập và hiển thị 'SIGN IN'
			profileLink.href = '/signin';
			profileText.textContent = 'SIGN IN';
		}
		document.addEventListener('DOMContentLoaded', function() {
			const searchBtn = document.getElementById('search-btn');
			const searchInput = document.getElementById('search-input');

			// Sự kiện khi người dùng nhấn nút tìm kiếm
			searchBtn.addEventListener('click', function() {
				const query = searchInput.value.trim(); // Lấy giá trị từ input

				if (query === '') {
					alert('Please enter a search term');
					return;
				}

				const page = 1;
				const limit = 18;

				// Tạo URL với query parameters
				const searchUrl = `/search?q=${encodeURIComponent(query)}&page=${page}&limit=${limit}`;

				// Chuyển hướng đến trang kết quả tìm kiếm
				window.location.href = searchUrl;
			});
		});
	</script>
</body>

<!-- Mirrored from hotflix.volkovdesign.com/main/profile.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Oct 2024 14:32:56 GMT -->
</html>